<div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Spreadsheet Columns</label>
    <p class="text-xs text-gray-500 mb-2">Edit column names and descriptions used for the Excel study table. Drag rows to reorder.</p>

    <div class="border border-gray-200 rounded-md">
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-2 py-2 w-8" aria-label="Drag"></th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Name</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500">Description</th>
                    <th class="px-4 py-2" aria-label="Actions"></th>
                </tr>
            </thead>
            <tbody id="columns-body" class="divide-y divide-gray-200">
                {% for col in columns %}
                <tr class="hover:bg-gray-50">
                    <td class="px-2 py-2 text-gray-400 cursor-move drag-handle" draggable="true">
                        <i class="fas fa-grip-vertical"></i>
                    </td>
                    <td class="px-4 py-2">
                        <input type="text" class="w-full px-2 py-1 border border-gray-300 rounded-md" value="{{ col.name }}" placeholder="Column name">
                    </td>
                    <td class="px-4 py-2">
                        <textarea class="w-full px-2 py-1 border border-gray-300 rounded-md" placeholder="Description (optional)">{{ col.description }}</textarea>
                    </td>
                    <td class="px-4 py-2 text-right">
                        <button type="button" class="text-red-600 hover:text-red-800" onclick="removeRow(this)">Remove</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <div class="px-4 py-2 bg-gray-50 flex justify-between">
            <div class="space-x-2">
                <button type="button" class="text-sm text-blue-600 hover:text-blue-800" onclick="addRow()">Add Column</button>
                <button type="button" class="text-sm text-gray-600 hover:text-gray-800" onclick="resetToDefault()">Reset to Default</button>
            </div>
        </div>
    </div>

    {{ form.spreadsheet_columns_json }}
</div>